<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>è¨˜äº‹ | Zoo Baby Information Site</title>

  <!-- Supabaseï¼ˆç›´å©ãç”¨ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ -->
  <meta name="supabase-url" content="https://hvhpfrksyytthupboaeo.supabase.co">
  <meta name="supabase-anon-key" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2aHBmcmtzeXl0dGh1cGJvYWVvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwNTc4MzQsImV4cCI6MjA3MjYzMzgzNH0.e5w3uSzajTHYdbtbVGDVFmQxcwe5HkyKSoVM7tMmKaY">

  <!-- â€»å¿…ãšãƒ«ãƒ¼ãƒˆçµ¶å¯¾ãƒ‘ã‚¹ã«ã™ã‚‹ -->
  <link rel="stylesheet" href="/assets/css/style.css" />

  <!-- å…±é€šJSï¼ˆåŒã˜ãçµ¶å¯¾ãƒ‘ã‚¹ï¼‰ -->
  <script defer src="/assets/js/app.js"></script>
  <!-- Markdown ã‚’ä½¿ã†å ´åˆ -->
  <script defer src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- æœ€ä½é™ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè£œåŠ©ã ã‘ï¼ˆå…±é€šCSSã‚’å°Šé‡ï¼‰ -->
  <style>
    .article{max-width:820px;margin:0 auto;padding:16px}
    .article h1{font-size:clamp(22px,5vw,32px);margin:6px 0 10px}
    .article .meta{color:#6b6b6b;margin-bottom:10px}
    .article img{max-width:100%;height:auto;border-radius:12px}
    .article .content :where(h2,h3){margin-top:1.6em}
  </style>

  <script>
  window.addEventListener('DOMContentLoaded', async () => {
    const slug = new URL(location.href).searchParams.get('slug');
    const $ = (id)=>document.getElementById(id);

    async function fetchJSON(path){
      const base = document.querySelector('meta[name="supabase-url"]')?.content?.trim();
      const key  = document.querySelector('meta[name="supabase-anon-key"]')?.content?.trim();
      if(!base || !key) throw new Error('Supabase URL/KEY missing');
      const u = new window.URL(path, base);
      const res = await fetch(u.toString(), { headers:{ apikey:key, Authorization:`Bearer ${key}` }, cache:'no-store' });
      if(!res.ok) throw new Error(await res.text());
      return res.json();
    }
    function setMeta(name, content){
      if(!content) return;
      let m = document.querySelector(`meta[property="${name}"],meta[name="${name}"]`);
      if(!m){ m=document.createElement('meta'); m.setAttribute(name.startsWith('og:')?'property':'name', name); document.head.appendChild(m); }
      m.setAttribute('content', content);
    }

    try{
      if(!slug) throw new Error('slug ãŒã‚ã‚Šã¾ã›ã‚“');
      const qs = new URLSearchParams({ select:'*', slug:`eq.${slug}`, limit:'1' }).toString();
      const [a] = await fetchJSON(`/rest/v1/articles?${qs}`);
      if(!a) throw new Error('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');

      document.title = `${a.title} | Zoo Baby Information Site`;
      $('a-title').textContent = a.title;
      $('a-meta').textContent  = `${new Date(a.published_at).toLocaleDateString('ja-JP',{year:'numeric',month:'short',day:'numeric'})} ï½œ ${a.author_name||'ç·¨é›†éƒ¨'}`;

      if(a.thumbnail_url){ $('a-thumb').src=a.thumbnail_url; $('a-thumb').alt=a.title; }
      else { $('thumb-wrap').style.display='none'; }

      $('a-body').innerHTML = a.body_html
        ? a.body_html
        : (a.body_md ? marked.parse(a.body_md) : '<p>æœ¬æ–‡æº–å‚™ä¸­ã§ã™ã€‚</p>');

      // canonical / OG / Twitter / JSON-LD
      const canon = location.origin + '/news/' + a.slug;
      let link = document.querySelector('link[rel="canonical"]');
      if(!link){ link=document.createElement('link'); link.rel='canonical'; document.head.appendChild(link); }
      link.href = canon;

      setMeta('og:type','article'); setMeta('og:title',a.title); setMeta('og:url',canon);
      if(a.thumbnail_url) setMeta('og:image', a.thumbnail_url);
      setMeta('twitter:card','summary_large_image');

      const ld = {
        "@context":"https://schema.org","@type":"Article",
        "headline":a.title,"datePublished":a.published_at,"dateModified":a.updated_at||a.published_at,
        "author":{"@type":"Person","name":a.author_name||"ç·¨é›†éƒ¨"},
        "image":a.thumbnail_url||undefined,"mainEntityOfPage":canon
      };
      const s=document.createElement('script'); s.type='application/ld+json'; s.textContent=JSON.stringify(ld);
      document.head.appendChild(s);
    }catch(e){
      console.error(e);
      $('a-error').textContent='è¨˜äº‹ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚';
      $('a-error').style.display='block';
    }
  });
  </script>
</head>
<body class="theme">
  <!-- å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="site-header" role="banner">
    <div class="site-header__left">
      <a class="brand" href="/index.html" aria-label="ãƒˆãƒƒãƒ—ã¸">
        <svg class="brand__icon" aria-hidden="true"><use href="/assets/icons/icons.svg#icon-logo"></use></svg>
        <span class="brand__title">Zoo Baby Information Site</span>
      </a>
    </div>
    <div class="site-header__right">
      <button class="pill-btn like-btn" aria-label="ãŠæ°—ã«å…¥ã‚Š">
        <svg class="icon" aria-hidden="true"><use href="/assets/icons/icons.svg#icon-heart"></use></svg>
      </button>
    </div>
  </header>

  <!-- å…±é€šã‚¿ãƒ–ãƒãƒ¼ï¼ˆSPã¯çµµæ–‡å­—ã‚¢ã‚¤ã‚³ãƒ³ï¼‰ -->
  <nav class="tabbar" aria-label="ãƒ¡ã‚¤ãƒ³">
    <a class="tabbar__link" href="/index.html"><span class="tabbar__icon">ğŸ </span><span class="tabbar__text">ãƒ›ãƒ¼ãƒ </span></a>
    <a class="tabbar__link is-active" href="/news/index.html" aria-current="page"><span class="tabbar__icon">ğŸ“°</span><span class="tabbar__text">ãƒ‹ãƒ¥ãƒ¼ã‚¹</span></a>
    <a class="tabbar__link" href="/babies/index.html"><span class="tabbar__icon">ğŸ¼</span><span class="tabbar__text">èµ¤ã¡ã‚ƒã‚“</span></a>
    <a class="tabbar__link" href="/calendar/index.html"><span class="tabbar__icon">ğŸ“…</span><span class="tabbar__text">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</span></a>
  </nav>

  <main class="container">
    <article class="article">
      <h1 id="a-title">èª­ã¿è¾¼ã¿ä¸­â€¦</h1>
      <p id="a-meta" class="meta"></p>
      <div id="thumb-wrap" style="margin:12px 0;"><img id="a-thumb" alt=""></div>
      <div id="a-error" class="card card--message" style="display:none"></div>
      <section id="a-body" class="content"></section>
    </article>
  </main>

  <footer class="site-footer" aria-label="ãƒ•ãƒƒã‚¿ãƒ¼">
    <small>Â© Zoo Baby Information</small>
  </footer>

  <!-- ï¼ˆä»»æ„ï¼‰Cloudflare Web Analytics ã® beacon ã‚’ä»–ãƒšãƒ¼ã‚¸åŒæ§˜ã«ã“ã“ã¸ -->
</body>
</html>
