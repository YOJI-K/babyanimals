<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ | ã©ã†ãƒ™ãƒ“</title>
  <meta name="description" content="ã©ã†ãƒ™ãƒ“ï¼ˆå‹•ç‰©åœ’ãƒ™ãƒ“ãƒ¼æƒ…å ±ï¼‰ã®ã‚ªãƒªã‚¸ãƒŠãƒ«è¨˜äº‹ãƒšãƒ¼ã‚¸ã§ã™ã€‚">

  <!-- OGPï¼ˆJSã§ä¸Šæ›¸ãã•ã‚Œã¾ã™ï¼‰ -->
  <meta property="og:type" content="article">
  <meta property="og:title" content="ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ | ã©ã†ãƒ™ãƒ“">
  <meta property="og:description" content="ã©ã†ãƒ™ãƒ“ã®ã‚ªãƒªã‚¸ãƒŠãƒ«è¨˜äº‹">
  <meta property="og:image" content="/assets/img/og.png">
  <meta property="og:url" content="">
  <link rel="icon" href="/assets/img/favicon.svg" type="image/svg+xml">

  <!-- Supabaseï¼ˆãƒ¡ã‚¿å€¤ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ -->
  <meta name="supabase-url" content="https://hvhpfrksyytthupboaeo.supabase.co">
  <meta name="supabase-anon-key" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2aHBmcmtzeXl0dGh1cGJvYWVvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwNTc4MzQsImV4cCI6MjA3MjYzMzgzNH0.e5w3uSzajTHYdbtbVGDVFmQxcwe5HkyKSoVM7tMmKaY">

  <!-- å…±é€šã‚¹ã‚¿ã‚¤ãƒ« -->
  <link rel="stylesheet" href="/assets/css/style.css" />
  <!-- Cloudflare Web Analytics -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token":"5b85d28b47c74f79b6ad1c1f19c0a758"}'></script>
  <!-- canonicalï¼ˆJSã§æœ€çµ‚URLã«ç½®ãæ›ãˆï¼‰ -->
  <link id="canonical" rel="canonical" href="https://babyanimals.pages.dev/news/">
  <style>
    /* è¨˜äº‹å°‚ç”¨ã®è»½ã„è¿½åŠ ã ã‘ï¼ˆå…±é€šãƒ‡ã‚¶ã‚¤ãƒ³ã¯ style.css ä¾å­˜ï¼‰ */
    .article-wrap{max-width:880px;margin-inline:auto;}
    .article-meta{color:#6f6166;font-size:14px;margin:10px 0 16px;}
    .article-cover{border-radius:16px;overflow:hidden;background:#fff;display:block}
    .article-cover img{width:100%;height:auto;display:block}
    .article-body{font-size:16.5px;line-height:1.9;}
    .article-body h2{font-size:22px;margin:24px 0 10px}
    .backline{display:inline-flex;align-items:center;gap:8px;margin:6px 0 18px;color:#6b3d52;text-decoration:none;font-weight:700}
    .backline::before{content:"â†";}
    @media(min-width:720px){ .article-body{font-size:18px} }
  </style>
</head>
<body class="theme">
  <!-- Headerï¼ˆCandy Ã— Emojiï¼‰ -->
  <header class="site-header site-header--candy" role="banner">
    <div class="site-header__left">
      <a class="brand" href="/index.html" aria-label="ãƒ›ãƒ¼ãƒ ã¸">
        <span class="brand__emoji" aria-hidden="true">ğŸ¾</span>
        <svg class="brand__icon" aria-hidden="true" focusable="false"><use href="/assets/icons/icons.svg#icon-logo"></use></svg>
        <span class="brand__title">ã©ã†ãƒ™ãƒ“</span>
      </a>
    </div>
    <div class="site-header__right">
      <button class="pill-btn like-btn" aria-label="ãŠæ°—ã«å…¥ã‚Š"><span class="emoji-icon">ğŸ’—</span></button>
      <button class="pill-btn search-btn" aria-label="æ¤œç´¢"><span class="emoji-icon">ğŸ”</span></button>
      <button class="pill-btn bell-btn" aria-label="ãŠçŸ¥ã‚‰ã›"><span class="emoji-icon">ğŸ””</span><span class="badge">!</span></button>
    </div>
  </header>

  <!-- Tabbarï¼ˆã‚¹ã‚¿ãƒƒã‚¯å‹ãƒ»çµµæ–‡å­—ã€å…±é€šãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ -->
  <nav class="tabbar tabbar--stack" aria-label="ãƒ¡ã‚¤ãƒ³">
    <a class="tabbar__link" href="/index.html" title="ãƒ›ãƒ¼ãƒ "><span class="tab-emoji">ğŸ </span><span class="tabbar__text">ãƒ›ãƒ¼ãƒ </span></a>
    <a class="tabbar__link is-active" href="/news/index.html" aria-current="page" title="ãƒ‹ãƒ¥ãƒ¼ã‚¹"><span class="tab-emoji">ğŸ“°</span><span class="tabbar__text">ãƒ‹ãƒ¥ãƒ¼ã‚¹</span></a>
    <a class="tabbar__link" href="/babies/index.html" title="èµ¤ã¡ã‚ƒã‚“"><span class="tab-emoji">ğŸ¼</span><span class="tabbar__text">èµ¤ã¡ã‚ƒã‚“</span></a>
    <a class="tabbar__link" href="/calendar/index.html" title="ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼"><span class="tab-emoji">ğŸ“…</span><span class="tabbar__text">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</span></a>
  </nav>

  <main class="container" id="main">
    <div class="article-wrap card">
      <a href="/news/index.html" class="backline">ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹</a>
      <article id="article">
        <header>
          <h1 id="title" class="page-title">â€”</h1>
          <div class="article-meta"><span id="date">â€”</span> ï½œ <span id="source">ç·¨é›†éƒ¨</span></div>
          <figure id="cover" class="article-cover" hidden>
            <img id="cover-img" src="" alt="">
          </figure>
        </header>
        <section id="body" class="article-body">èª­ã¿è¾¼ã¿ä¸­â€¦</section>
      </article>
    </div>
  </main>

  <footer class="site-footer" aria-label="ãƒ•ãƒƒã‚¿ãƒ¼">
    <small>Â© ã©ã†ãƒ™ãƒ“ï¼ˆå‹•ç‰©åœ’ãƒ™ãƒ“ãƒ¼æƒ…å ±ï¼‰</small>
  </footer>

  <!-- å…±é€šJSï¼ˆã‚¿ãƒ–ã®activeä»˜ä¸ãªã©ã«åˆ©ç”¨ï¼‰ -->
  <script src="/assets/js/app.js" defer></script>

  <!-- è¨˜äº‹æç”»ç”¨JS -->
  <script>
  (function(){
    const qs = (s,ctx=document)=>ctx.querySelector(s);
    const SUPA_URL = document.querySelector('meta[name="supabase-url"]').content;
    const ANON     = document.querySelector('meta[name="supabase-anon-key"]').content;

    // slug ã¯ ?slug=xxx ã‹ /news/xxxï¼ˆ_redirectsã§å¤‰æ›æ¸ˆã¿ï¼‰ã®ã©ã¡ã‚‰ã«ã‚‚å¯¾å¿œ
    function getSlug(){
      const u = new URL(location.href);
      const s = u.searchParams.get('slug');
      if (s) return s;
      // å¿µã®ãŸã‚ /news/xxx ã®ã¾ã¾æ¥ãŸæ™‚
      const m = location.pathname.match(/\/news\/([^\/?#]+)/);
      return m ? m[1] : '';
    }

    async function fetchJSON(path){
      const url = new URL(path, SUPA_URL);
      const res = await fetch(url.toString(), {
        headers:{ apikey:ANON, Authorization:`Bearer ${ANON}` },
        cache:'no-store'
      });
      if(!res.ok) throw new Error('HTTP '+res.status);
      return res.json();
    }

    function fmtDate(iso){
      const d = new Date(iso); if(isNaN(d)) return '';
      return d.toLocaleDateString('ja-JP', {year:'numeric', month:'long', day:'numeric'});
    }

    function setOG({title, description, image, url}){
      const set = (sel, name, val) => {
        if (!val) return;
        let el = qs(sel);
        if (!el) { el = document.createElement('meta'); el.setAttribute(name, sel.includes('property')?'property':'name'); document.head.appendChild(el); }
        el.setAttribute('content', val);
      };
      set('meta[property="og:title"]','property',title);
      set('meta[property="og:description"]','property',description);
      set('meta[property="og:image"]','property',image);
      set('meta[property="og:url"]','property',url);
      // canonical
      const can = qs('#canonical'); if (can) can.href = url;
      document.title = `${title} | ã©ã†ãƒ™ãƒ“`;
    }

    async function init(){
      const slug = getSlug();
      if(!slug){ qs('#body').textContent = 'è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚'; return; }

      // è‡ªã‚µã‚¤ãƒˆè¨˜äº‹ã®ã¿ï¼ˆstatus=published ã®ã¿è¡¨ç¤ºï¼‰
      const rows = await fetchJSON(`/rest/v1/articles?slug=eq.${encodeURIComponent(slug)}&status=eq.published&select=title,body_html,cover_url,published_at,author`);
      const a = rows?.[0];
      if(!a){ qs('#body').textContent = 'è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚'; return; }

      qs('#title').textContent = a.title || '(ç„¡é¡Œ)';
      qs('#date').textContent  = a.published_at ? fmtDate(a.published_at) : '';
      qs('#source').textContent= a.author || 'ç·¨é›†éƒ¨';

      if (a.cover_url){
        qs('#cover-img').src = a.cover_url;
        qs('#cover-img').alt = a.title || '';
        qs('#cover').hidden = false;
      }

      // å®‰å…¨ãªæœ€å°é™ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚ºï¼ˆåŸºæœ¬ã¯ CMS å´ã§HTMLã‚’ç”Ÿæˆã—ã¦ã„ã‚‹å‰æï¼‰
      qs('#body').innerHTML = a.body_html || '';

      const url = `${location.origin}/news/${slug}`;
      setOG({
        title: a.title,
        description: (qs('#body').textContent || '').trim().slice(0, 120),
        image: a.cover_url || '/assets/img/og.png',
        url
      });
    }

    init().catch(e=>{
      console.error(e);
      qs('#body').textContent = 'èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
    });
  })();
  </script>
</body>
</html>
